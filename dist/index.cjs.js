"use strict";var e=require("react");function t(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var r=t(e),n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var c={},i={};!function(t){var r=n&&n.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.scripts=void 0;var o=e;t.scripts={};var c=function(e){var r=document.querySelector('script[src="'+e+'"]');if(r)return t.scripts[e]={loading:!1,error:null,scriptEl:r}};t.default=function(e){var n=e.src,u=e.checkForExisting,s=void 0!==u&&u,a=r(e,["src","checkForExisting"]),l=n?t.scripts[n]:void 0;!l&&s&&n&&i&&(l=c(n));var f=(0,o.useState)(l?l.loading:Boolean(n)),d=f[0],p=f[1],v=(0,o.useState)(l?l.error:null),b=v[0],y=v[1],O=(0,o.useState)(!1),g=O[0],j=O[1];return(0,o.useEffect)((function(){if(i&&n&&!g&&!b){var e;!(l=t.scripts[n])&&s&&(l=c(n)),l?e=l.scriptEl:((e=document.createElement("script")).src=n,Object.keys(a).forEach((function(t){void 0===e[t]?e.setAttribute(t,a[t]):e[t]=a[t]})),l=t.scripts[n]={loading:!0,error:null,scriptEl:e});var r=function(){l&&(l.loading=!1),p(!1),j(!0)},o=function(e){l&&(l.error=e),y(e)};return e.addEventListener("load",r),e.addEventListener("error",o),document.body.appendChild(e),function(){e.removeEventListener("load",r),e.removeEventListener("error",o)}}}),[n]),[d,b]};var i="undefined"!=typeof window&&void 0!==window.document}(i),function(e){var t=n&&n.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.scripts=e.default=void 0;var r=i;Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t(r).default}}),Object.defineProperty(e,"scripts",{enumerable:!0,get:function(){return r.scripts}})}(c);var u=o(c);exports.useStackOneHub=function({connectUrl:e}={}){const[t,n]=r.useState("closed"),[o,c]=r.useState(),[i,s]=u({src:e||"https://app.stackone.com/stackone/connect.js",checkForExisting:!0});r.useEffect((()=>{"open"!==t&&"closed"!==t&&(s?"opening"===t&&n("closed"):i||"opening"===t&&o&&(n("open"),Connect.start({...o,onClose:()=>{n("closed"),o.onCancel?.()}})))}),[s,i,t,o]);return{startConnect:r.useCallback((e=>{if(s)throw"Could not initiate StackOne Hub.";"open"!==t&&(c(e),n("opening"))}),[i,s])}};
